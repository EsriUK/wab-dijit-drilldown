String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),Array.prototype.filter||(Array.prototype.filter=function(a){"use strict";var b,c,d,e,f,g=0;if(void 0===this||null===this)throw new TypeError;if(b=Object(this),c=b.length>>>0,"function"!=typeof a)throw new TypeError;for(d=[],e=arguments.length>=2?arguments[1]:void 0,g=0;c>g;g++)g in b&&(f=b[g],a.call(e,f,g,b)&&d.push(f));return d}),define(["dojo/_base/declare","esri/tasks/locator","./PickList","./PickListItem","dojo/Deferred"],function(a,b,c,d,e){var f=/[^a-zA-Z]/g,g=/[^0-9]/g,h=function(a,b){var c,d,e=0,f=a.length,g="",h=[];for(e=0;f>e;e+=1)c=a[e],d=b[c],d.length>0&&h.push(d);return h.length>0&&(g=h.join(", ")),g},i=function(a,b,c,e){var f,g,i,j=0,k=0;for(j=0,k=a.length;k>j;j+=1)f=a[j],g=f.attributes,i=h(e,g),i.length>0&&(b.hasOwnProperty(i)?b[i].addCandidate(f):b[i]=new d({SortDescription:i,Description:i,Addresses:[f],Level:2}))},j=function(a,b){return a.localeCompare(b)},k=function(a,b){var c,d,e=a.replace(f,""),h=b.replace(f,"");return e===h?(c=parseInt(a.replace(g,""),10),d=parseInt(b.replace(g,""),10),c===d?0:c>d?1:-1):e>h?1:-1};return a([b],{locatorType:"None",streetGrouping:[],premiseGrouping:[],paoFields:{PAO_TEXT:"",PAO_START_NUMBER:"",PAO_START_SUFFIX:"",PAO_END_NUMBER:"",PAO_END_SUFFIX:""},saoFields:{SAO_TEXT:"",SAO_START_NUMBER:"",SAO_START_SUFFIX:"",SAO_END_NUMBER:"",SAO_END_SUFFIX:""},_geocodeHandler:function(a,b,d,e,f){var g=this;try{this.resultsPickList=new c,this._buildPickList(a).then(function(){g._successHandler([g.resultsPickList],"onAddressToLocationsComplete",d,f)})}catch(h){this._errorHandler(h,e,f)}},_buildPickList:function(a){var b,f,g,l,m,n,o,p,q=new e,r={},s={},t=0,u=0,v=new c,w=this.streetFields.STREET_DESCRIPTOR,x=this.streetGrouping,y=this.premiseGrouping,z=function(a,b){return j(a.SortDescription,b.SortDescription)},A=function(a,b){return k(a.SortDescription,b.SortDescription)};if(a.candidates.length>0){b=a.candidates,i(b,r,w,x);for(g in r)if(r.hasOwnProperty(g))if(s={},r[g].Addresses.length>1){for(l=new d({Description:g,SortDescription:r[g].SortDescription}),m=r[g].Addresses,t=0,u=m.length;u>t;t+=1)p=m[t].attributes,f=h(y,p),o=null,f.length>0&&(o=m[t],o.SortDescription=this._getSAOText(p),s.hasOwnProperty(f)?s[f].addCandidate(o):s[f]=new d({SortDescription:this._getPAOText(p),Description:this._getListLevelDescription(1,p),Addresses:[o],Level:1}));for(n in s)s.hasOwnProperty(n)&&(s[n].Addresses.sort(A),l.addCandidate(s[n]));l.Addresses.sort(A),v.addItem(l)}else v.addItem(r[g]);v.PickListItems.sort(z),this.resultsPickList=v,q.resolve()}else this.resultsPickList=v,q.resolve();return q.promise}})});