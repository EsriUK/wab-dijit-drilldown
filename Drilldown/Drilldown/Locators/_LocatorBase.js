String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),Array.prototype.filter||(Array.prototype.filter=function(a){"use strict";var b,c,d,e,f,g=0;if(void 0===this||null===this)throw new TypeError;if(b=Object(this),c=b.length>>>0,"function"!=typeof a)throw new TypeError;for(d=[],e=arguments.length>=2?arguments[1]:void 0,g=0;c>g;g++)g in b&&(f=b[g],a.call(e,f,g,b)&&d.push(f));return d});var _isNullOrEmpty=function(a){return void 0===a||null===a||""===a},_paoSaoNumberRange=function(a,b,c,d){var e=a.trim()+b.trim(),f=c.trim()+d.trim();return _isNullOrEmpty(e)===!1&&_isNullOrEmpty(f)===!1?e+"-"+f:e+f};define(["dojo/_base/declare","esri/tasks/locator","./PickList","./PickListItem","dojo/Deferred"],function(a,b,c,d,e){var f=function(a,b){var c,d,e=0,f=a.length,g="",h=[];for(e=0;f>e;e+=1)c=a[e],d=b[c],void 0!==d&&d.length>0&&h.push(d);return h.length>0&&(g=h.join(", ")),g},g=function(a,b,c){var e,g,h,i=0,j=0;for(i=0,j=a.length;j>i;i+=1)e=a[i],g=e.attributes,h=f(c,g),h.length>0&&(b.hasOwnProperty(h)?b[h].addCandidate(e):b[h]=new d({SortDescription:h,Description:h,Addresses:[e],Level:2}))},h=function(a,b){return a.localeCompare(b)},i=function(a,b){function c(a){for(var b,c,d,e=[],f=0,g=-1,h=0;b=(c=a.charAt(f++)).charCodeAt(0);)d=46===b||b>=48&&57>=b,d!==h&&(e[++g]="",h=d),e[g]+=c;return e}var d,e,f=0,g=c(a),h=c(b);for(f=0;g[f]&&h[f];f++)if(g[f]!==h[f])return d=Number(g[f]),e=Number(h[f]),d===g[f]&&e===h[f]?d-e:g[f]>h[f]?1:-1;return g.length-h.length};return a([b],{locatorType:"None",streetGrouping:[],premiseGrouping:[],paoFields:{PAO_TEXT:"",PAO_START_NUMBER:"",PAO_START_SUFFIX:"",PAO_END_NUMBER:"",PAO_END_SUFFIX:""},saoFields:{SAO_TEXT:"",SAO_START_NUMBER:"",SAO_START_SUFFIX:"",SAO_END_NUMBER:"",SAO_END_SUFFIX:""},_geocodeHandler:function(a,b,d,e,f){var g=this;try{this.resultsPickList=new c,this._buildPickList(a).then(function(){g._successHandler([g.resultsPickList],"onAddressToLocationsComplete",d,f)})}catch(h){this._errorHandler(h,e,f)}},_getListLevelDescription:function(a,b){var c="",d=this.streetFields;switch(a){case 1:c=[this._getPAOText(b,!1),b[d.STREET_DESCRIPTOR],b[d.LOCALITY_NAME],b[d.TOWN_NAME],b[d.ADMINISTRATIVE_AREA]].filter(Boolean).join(", ");break;case 2:c=[b[d.STREET_DESCRIPTOR],b[d.LOCALITY_NAME],b[d.TOWN_NAME],b[d.ADMINISTRATIVE_AREA]].filter(Boolean).join(", ")}return c},_buildPickList:function(a){var b,j,k,l,m,n,o,p,q=new e,r={},s={},t=0,u=0,v=new c,w=this.streetGrouping,x=this.premiseGrouping,y=function(a,b){return h(a.SortDescription,b.SortDescription)},z=function(a,b){return i(a.SortDescription,b.SortDescription)};if(!_isNullOrEmpty(a.candidates)&&a.candidates.length>0){b=a.candidates,g(b,r,w);for(k in r)if(r.hasOwnProperty(k))if(s={},r[k].Addresses.length>1){for(l=new d({Description:k,SortDescription:r[k].SortDescription}),m=r[k].Addresses,t=0,u=m.length;u>t;t+=1)p=m[t].attributes,j=f(x,p),o=null,j.length>0&&(o=m[t],o.SortDescription=this._getSAOText(p,!0),s.hasOwnProperty(j)?s[j].addCandidate(o):s[j]=new d({SortDescription:this._getPAOText(p,!0),Description:this._getListLevelDescription(1,p),Addresses:[o],Level:1}));for(n in s)s.hasOwnProperty(n)&&(s[n].Addresses.sort(z),l.addCandidate(s[n]));l.Addresses.sort(z),v.addItem(l)}else v.addItem(r[k]);v.PickListItems.sort(y),this.resultsPickList=v,q.resolve()}else this.resultsPickList=v,q.resolve();return q.promise}})});